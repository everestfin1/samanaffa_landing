# Database
DATABASE_URL="postgresql://username:password@localhost:5432/sama_naffa_db"

# NextAuth.js
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# Vercel Blob
BLOB_READ_WRITE_TOKEN="vercel_blob_rw_xxx"

# Email (Nodemailer)
EMAIL_HOST="smtp.gmail.com"
EMAIL_PORT=587
EMAIL_USER="your-email@gmail.com"
EMAIL_PASS="your-app-password"
EMAIL_SENDER="Sama Naffa <noreply@samanaffa.com>"

# BulkSMS.com (SMS OTP) - Choose ONE authentication method
# Option 1: API Token authentication (recommended)
# Format: "token-id:token-secret" (e.g., "BBDE1B476E03498AA768F66A286AABDC-01-B:9jSbVDK20!MXdfRGiIIFu#ffUE8*S")
BULKSMS_TOKEN="your-token-id:your-token-secret"

# Option 2: Username/Password authentication (alternative)
# BULKSMS_USERNAME="your-bulksms-username"
# BULKSMS_PASSWORD="your-bulksms-password"

BULKSMS_SENDER_ID="SamaNaffa"  # Optional: Your sender ID (must be approved by BulkSMS)

# Twilio (SMS OTP) - Keep as backup if needed
# TWILIO_ACCOUNT_SID="your-twilio-account-sid"
# TWILIO_AUTH_TOKEN="your-twilio-auth-token"
# TWILIO_PHONE_NUMBER="+1234567890"

# SendGrid (Alternative email service)
SENDGRID_API_KEY="your-sendgrid-api-key"
SENDGRID_FROM_EMAIL="noreply@samanaffa.com"

# Admin Configuration
ADMIN_EMAIL="admin@samanaffa.com"
ADMIN_PASSWORD="secure-admin-password"

# Admin Security
ADMIN_JWT_SECRET="your-super-secure-jwt-secret-here-change-in-production"
ADMIN_SESSION_SECRET="your-session-secret-here"
ADMIN_RATE_LIMIT_MAX_ATTEMPTS="5"
ADMIN_RATE_LIMIT_WINDOW_MS="900000"
ADMIN_RATE_LIMIT_BLOCK_MS="3600000"

# User Rate Limiting
LOGIN_RATE_LIMIT_MAX_ATTEMPTS="5"
LOGIN_RATE_LIMIT_WINDOW_MS="900000"
LOGIN_RATE_LIMIT_BLOCK_MS="1800000"

OTP_RATE_LIMIT_MAX_ATTEMPTS="3"
OTP_RATE_LIMIT_WINDOW_MS="3600000"
OTP_RATE_LIMIT_BLOCK_MS="3600000"

TRANSACTION_RATE_LIMIT_MAX_ATTEMPTS="10"
TRANSACTION_RATE_LIMIT_WINDOW_MS="60000"
TRANSACTION_RATE_LIMIT_BLOCK_MS="300000"

KYC_RATE_LIMIT_MAX_ATTEMPTS="5"
KYC_RATE_LIMIT_WINDOW_MS="3600000"
KYC_RATE_LIMIT_BLOCK_MS="3600000"

# Intouch Payment Provider
# Environment: 'test' or 'production' (defaults to production if not set, or 'test' if NODE_ENV=development)
# INTOUCH_ENVIRONMENT="test"

# Production Credentials
NEXT_PUBLIC_INTOUCH_MERCHANT_ID="your-production-merchant-id"
INTOUCH_API_KEY="your-production-api-key"
NEXT_PUBLIC_INTOUCH_DOMAIN="your-production-domain.com"

# Test/Sandbox Credentials (used when INTOUCH_ENVIRONMENT=test)
NEXT_PUBLIC_INTOUCH_TEST_MERCHANT_ID="your-test-merchant-id"
INTOUCH_TEST_API_KEY="your-test-api-key"
NEXT_PUBLIC_INTOUCH_TEST_DOMAIN="your-test-domain.com"

# Intouch Webhook Configuration
# Basic Auth credentials for webhook verification (request these from InTouch team)
INTOUCH_BASIC_AUTH_USERNAME="your-webhook-username"
INTOUCH_BASIC_AUTH_PASSWORD="your-webhook-password"

# Test/Sandbox Basic Auth credentials (used in development/staging)
INTOUCH_BASIC_AUTH_USERNAME_TEST="your-test-webhook-username"
INTOUCH_BASIC_AUTH_PASSWORD_TEST="your-test-webhook-password"

# Optional: HMAC signature verification (if InTouch also sends signatures)
INTOUCH_WEBHOOK_SECRET="your-webhook-secret-here"

# Allow unsigned callbacks during testing (set to false in production)
INTOUCH_ALLOW_UNSIGNED_CALLBACKS="true"

# Payment Security Configuration
# Rate limiting for payment callbacks (prevents abuse)
PAYMENT_RATE_LIMIT_WINDOW="900000"          # 15 minutes in milliseconds
PAYMENT_RATE_LIMIT_MAX_REQUESTS="10"        # Max callback requests per window per IP

# Payment amount validation (prevents tampering)
PAYMENT_MAX_AMOUNT="10000000"               # Maximum: 10M CFA
PAYMENT_MIN_AMOUNT="100"                    # Minimum: 100 CFA

# Request validation (security hardening)
PAYMENT_MAX_PAYLOAD_SIZE="10240"            # Maximum: 10KB payload size
PAYMENT_IDEMPOTENCY_TTL="86400000"          # Idempotency key TTL: 24 hours in ms

# Application
NODE_ENV="development"
